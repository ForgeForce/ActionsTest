name: Test Manual

on: workflow_dispatch

jobs:

  publish:

    runs-on: macos-latest

    steps:

    - name: Checkout project sources

      uses: actions/checkout@v2

    - uses: actions/setup-java@v3

      with:

        distribution: 'zulu' # See 'Supported distributions' for available options

        java-version: '17'
    - name: Restore cache
      id: crestore-cache
      uses: actions/cache/restore@v3
      with:
        path: cache
        key: blow_caches
    - name: blow
      run: java -jar Snowblower-1.0.38-all.jar --cache cache --output blow --branch all --checkout --push --start-ver 1.14.4 --target-ver 19w37a --remote ${{secrets.REMOTE}}
    - name: Delete old caches
      run: |
         gh extension install actions/gh-actions-cache
         gh actions-cache delete blow_caches --confirm
      env:
        GH_TOKEN: ${{ github.token }}
    - name: Save caches
      uses: actions/cache/save@v3
      with:
        path: cache
        key: ${{ steps.crestore-cache.outputs.cache-primary-key }}
